package $!{classPackage}.controller;

#if($keyFields.size() > 1)
import $!{classPackage}.entity.$!{className}PK;
#end
import $!{classPackage}.entity.$!{className};
import $!{classPackage}.controller.request.$!{className}Request;
import $!{classPackage}.service.$!{className}Service;
import $!{classPackage}.util.ObjectUtil;
import $!{classPackage}.util.ResponseUtil;
import $!{classPackage}.util.PageInfoUtil;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;
import com.alibaba.fastjson.JSONObject;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

/**
 * $!{comment}对外接口层
 *
 * @author $!{authorName}
 * @email  $!{authorEmail}
 * @date   $!{createTime}
 */
@RestController
@RequestMapping("/$!{entityName}")
public class $!{className}Controller {

    @Autowired
    $!{className}Service $!{entityName}Service;

    @RequestMapping(value = "/save$!{className}", method = RequestMethod.POST, produces="application/json;charset=UTF-8")
    @ResponseBody
    public ResponseUtil save$!{className}(@RequestBody $!{className}Request $!{entityName}Request) {
        int result = $!{entityName}Service.save$!{className}($!{entityName}Request.get$!{className}());
        if(result == 1) {
            return new ResponseUtil(1, "创建$!{comment}成功！", null);
        }
        return new ResponseUtil(0, "创建$!{comment}失败！", null);
    }
#if($keyFields.size() > 0)

    @RequestMapping(value = "/update$!{className}ByKey", method = RequestMethod.POST, produces="application/json;charset=UTF-8")
    @ResponseBody
    public ResponseUtil update$!{className}ByKey(@RequestBody $!{className}Request $!{entityName}Request) {
#if($notNullfields.size() > 0)
#foreach ($!{field} in $!{notNullfields})
        if($!{entityName}Request.get$!{field.filedName}() == null) {
            return new ResponseUtil(0, "$!{field.comment}不能为null！", null);
        }
#end
#end
        int result = $!{entityName}Service.update$!{className}ByKey($!{entityName}Request.get$!{className}());
        if(result == 1) {
            return new ResponseUtil(1, "修改$!{comment}成功！", null);
        }
        return new ResponseUtil(0, "修改$!{comment}失败！", null);
    }

    @RequestMapping(value = "/delete$!{className}ByKey", method = RequestMethod.POST, produces="application/json;charset=UTF-8")
    @ResponseBody
    public ResponseUtil delete$!{className}ByKey(@RequestBody $!{className}Request $!{entityName}Request) {
#if($keyFields.size() > 0)
#foreach ($!{field} in $!{keyFields})
        if($!{entityName}Request.get$!{field.filedName}() == null) {
            return new ResponseUtil(0, "$!{field.comment}不能为null！", null);
        }
#end
#end
        int result = $!{entityName}Service.delete$!{className}ByKey(#foreach(${field} in ${keyFields})#if($velocityCount == 1)$!{entityName}Request.get$!{field.filedName}()#else, $!{entityName}Request.get$!{field.filedName}()#end#end);
        if(result > 0) {
            return new ResponseUtil(1, "删除$!{comment}成功！", null);
        }
        return new ResponseUtil(0, "删除$!{comment}失败！", null);
    }

    @RequestMapping(value = "/deleteBatch$!{className}ByKey", method = RequestMethod.POST, produces="application/json;charset=UTF-8")
    @ResponseBody
    public ResponseUtil deleteBatch$!{className}ByKey(@RequestBody $!{className}Request $!{entityName}Request) {
#if($keyFields.size() > 1)
        List<$!{className}PK> $!{entityName}PKs = $!{entityName}Request.get$!{className}PKs();
        if($!{entityName}PKs == null || $!{entityName}PKs.size() < 1) {
            return new ResponseUtil(0, "主键不能为null！", null);
        }
        int result = $!{entityName}Service.deleteBatch$!{className}ByKey($!{entityName}PKs);
#elseif($keyFields.size() == 1)
        List<$!{keyFields.get(0).type}> $!{keyFields.get(0).entityName}s = $!{entityName}Request.get$!{keyFields.get(0).filedName}s();
        if($!{keyFields.get(0).entityName}s == null || $!{keyFields.get(0).entityName}s.size() < 1) {
            return new ResponseUtil(0, "主键不能为null！", null);
        }
        int result = $!{entityName}Service.deleteBatch$!{className}ByKey($!{keyFields.get(0).entityName}s);
#end
        if(result > 0) {
            return new ResponseUtil(1, "删除$!{comment}成功！", result);
        }
        return new ResponseUtil(0, "删除$!{comment}失败！", null);
    }

    @RequestMapping(value = "/get$!{className}ByKey", method = RequestMethod.POST, produces="application/json;charset=UTF-8")
    @ResponseBody
    public ResponseUtil get$!{className}ByKey(@RequestBody $!{className}Request $!{entityName}Request) {
#if($keyFields.size() > 0)
#foreach ($!{field} in $!{keyFields})
        if($!{entityName}Request.get$!{field.filedName}() == null) {
            return new ResponseUtil(0, "$!{field.comment}不能为null！", null);
        }
#end
#end
        $!{className} $!{entityName} = $!{entityName}Service.get$!{className}ByKey(#foreach(${field} in ${keyFields})#if($velocityCount == 1)$!{entityName}Request.get$!{field.filedName}()#else, $!{entityName}Request.get$!{field.filedName}()#end#end);
        return new ResponseUtil(1, "OK", $!{entityName}.toString());
    }

#end
    @RequestMapping(value = "/list$!{className}ByParamAndPage", method = RequestMethod.POST, produces="application/json;charset=UTF-8")
    @ResponseBody
    public ResponseUtil list$!{className}ByParamAndPage(@RequestBody $!{className}Request $!{entityName}Request) {
        int pageIndex = 1, pageSize = 100;
        if(schoolRequest.getPageNum() != 0) {
            pageNum = schoolRequest.getPageNum();
        }
        if(schoolRequest.getPageSize() != 0) {
            pageSize = schoolRequest.getPageSize();
        }
        PageInfoUtil<$!{className}> $!{entityName}List = $!{entityName}Service.list$!{className}ByParamAndPage($!{entityName}Request.get$!{className}(), pageNum, pageSize);
        return new ResponseUtil(1, "OK", $!{entityName}List);
    }
}
